<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ORE Custom Tiles Bot</title>
  <script src="https://unpkg.com/@solana/web3.js@1.95.2/lib/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://auth.privy.io/v1/core.umd.min.js"></script>
  <style>
    body{margin:0;background:#000;color:#0f0;font-family:Arial;text-align:center;padding:20px;}
    h1{font-size:40px;margin:20px 0;}
    button{padding:18px 36px;margin:15px;background:#00ff00;color:black;border:none;border-radius:12px;font-size:22px;font-weight:bold;cursor:pointer;}
    button:disabled{background:#555;cursor:not-allowed;}
    button.stop{background:#ff0033;}
    #grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;max-width:420px;margin:40px auto;}
    .tile{width:70px;height:70px;background:#b8860b;color:white;font-size:28px;font-weight:bold;display:flex;align-items:center;justify-content:center;cursor:pointer;border:4px solid #333;border-radius:12px;}
    .tile.selected{background:#00ff00;color:black;border-color:#00ff00;box-shadow:0 0 20px #0f0;}
    .log{background:#111;padding:20px;height:380px;overflow-y:auto;margin:30px auto;max-width:700px;border-radius:12px;font-family:monospace;font-size:15px;border:1px solid #0f0;}
    input{padding:15px;width:280px;margin:15px;border-radius:12px;background:#222;color:#0f0;border:2px solid #0f0;font-size:18px;text-align:center;}
  </style>
</head>
<body>
  <h1>ORE Custom Tiles Bot</h1>
  <div id="root"></div>

<script>
  const PRIVY_APP_ID = "cmi8rgcw9008nl30cnnxgn9mw"; // Your ID – good

  const RPC = "https://mainnet.helius-rpc.com/?api-key=8952f5e0-8f66-465a-8a4c-29152df1f3cd";

  // CORRECT ORE v2 Program ID (from Solscan – 44 chars)
  const ORE_PROGRAM = new solanaWeb3.PublicKey("oreV3EG1i9BEgiAJ8b177Z2S2rMarzak4NMv1kULvWv");
  const ORE_MINT = new solanaWeb3.PublicKey("oreoU2P8bN6jkk3jbaiVxYnG1dCXcYxwhwyK9jSybcp");

  const { useState, useEffect } = React;

  function App() {
    const [wallet,setWallet] = useState(null);
    const [balance,setBalance] = useState(0);
    const [tiles,setTiles] = useState([]);
    const [perTile,setPerTile] = useState(0.0001);
    const [total,setTotal] = useState(0);
    const [streak,setStreak] = useState(0);
    const [running,setRunning] = useState(false);
    const [log,setLog] = useState(["Bot ready"]);

    const logMsg = m => setLog(l=>[...l.slice(-30),`${new Date().toLocaleTimeString()}: ${m}`]);

    useEffect(()=>{
      const tryInit = () => {
        if(window.PrivyIO){
          const privy = new PrivyIO({appId:PRIVY_APP_ID});
          privy.on('login', async user=>{
            setWallet(user.wallet);
            logMsg("Connected: "+user.wallet.address.slice(0,8)+"...");
            const c=new solanaWeb3.Connection(RPC);
            const b=await c.getBalance(new solanaWeb3.PublicKey(user.wallet.address));
            setBalance(b/1e9);
          });
          window.privy=privy;
        }else setTimeout(tryInit,500);
      };
      tryInit();
    },[]);

    const toggle=i=>{if(running)return;setTiles(t=>t.includes(i)?t.filter(x=>x!==i):[...t,i].sort((a,b)=>a-b));};

    const start=()=>{
      if(tiles.length===0)return alert("Select tiles!");
      setTotal(tiles.length*perTile);
      setRunning(true);
      setStreak(0);
      logMsg(`STARTED – ${tiles.length} tiles @ ${perTile} SOL`);
      setTimeout(bet,3000);
    };

    const bet=async()=>{
      if(!running)return;
      const lamports=Math.floor((total/tiles.length)*1e9);
      const conn=new solanaWeb3.Connection(RPC);
      const ixs=tiles.map(t=>new solanaWeb3.TransactionInstruction({
        programId:ORE_PROGRAM,
        keys:[
          {pubkey:new solanaWeb3.PublicKey(wallet.address),isSigner:true,isWritable:true},
          {pubkey:ORE_PROGRAM,isSigner:false,isWritable:true}
        ],
        data:Buffer.from([2,t,...new Uint8Array(new BigUint64Array([BigInt(lamports)]).buffer)])
      }));
      try{
        const tx=new solanaWeb3.Transaction().add(...ixs);
        tx.recentBlockhash=(await conn.getLatestBlockhash()).blockhash;
        tx.feePayer=new solanaWeb3.PublicKey(wallet.address);
        const signed=await wallet.signTransaction(tx);
        const sig=await conn.sendRawTransaction(signed.serialize());
        logMsg(`Bet ${total.toFixed(6)} SOL → ${sig.slice(0,8)}...`);
        setTimeout(check,65000);
      }catch(e){logMsg("Error: "+e.message);setTimeout(bet,10000);}
    };

    const check=async()=>{
      if(!running)return;
      const d=await (await fetch("https://ore.supply/api/recent?limit=1")).json();
      const win=d[0].winning_tile;
      if(tiles.includes(win)){
        logMsg(`HIT ${win+1}!!! Resetting bet`);
        setStreak(0); setTotal(tiles.length*perTile);
      }else{
        const next=total*2;
        setStreak(s=>s+1);
        setTotal(next>balance*0.8?tiles.length*perTile:next);
        logMsg(`Miss – streak ${streak+1} → next ${total.toFixed(6)} SOL`);
      }
      const b=await new solanaWeb3.Connection(RPC).getBalance(new solanaWeb3.PublicKey(wallet.address));
      setBalance(b/1e9);
      if(running)setTimeout(bet,62000);
    };

    return React.createElement('div',null,
      !wallet ?
        React.createElement('button',{onClick:()=>window.privy?.login()},"SIGN IN WITH PRIVY") :
        React.createElement(React.Fragment,null,
          React.createElement('p',null,`Balance: ${balance.toFixed(4)} SOL`),
          React.createElement('div',{id:'grid'},
            Array.from({length:25},(_,i)=>React.createElement('div',{
              key:i,className:`tile ${tiles.includes(i)?'selected':''}`,onClick:()=>toggle(i)
            },i+1))
          ),
          React.createElement('p',null,"Tiles: "+(tiles.length?tiles.map(t=>t+1).join(", "):"none")),
          React.createElement('input',{type:"number",step:"0.000001",defaultValue:"0.0001",
            onChange:e=>setPerTile(parseFloat(e.target.value)||0.0001)}),
          React.createElement('br',null),
          React.createElement('button',{onClick:start,disabled:running},"START BOT"),
          running&&React.createElement('button',{className:"stop",onClick:()=>setRunning(false)},"STOP"),
          React.createElement('p',null,`Bet: ${total.toFixed(6)} SOL | Streak: ${streak}`),
          React.createElement('div',{className:'log'},log.map((l,i)=>React.createElement('div',{key:i},l)))
        )
    );
  }

  ReactDOM.render(React.createElement(App), document.getElementById('root'));
</script>
</body>
</html>





